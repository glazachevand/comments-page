!function(){"use strict";var e={566:function(e,t,n){var o=n(411),i=n(350),r=n(984);const s=new r.H(o.d),a=new i.u(o.d);function c(e){a.removeMessages();const t=(0,r.G)(e);t.length>0?a.showErrors(t):(a.renderNewComment(s.addComment(e)),a.clearForm(e))}a.renderTestData(s.comments),a.form.addEventListener("submit",(function(e){e.preventDefault(),c(this)})),document.addEventListener("keydown",(function(e){"Enter"==e.key&&c(a.form)})),a.form.addEventListener("input",a.removeMessage),a.list.addEventListener("click",(function(e){if(!e.target.hasAttribute("data-action"))return;const t=e.target.closest("li");if(t)switch(e.target.getAttribute("data-action")){case"remove":confirm("Удалить комментарий?")&&(s.removeComment(+t.dataset.key),a.removeCommentFromView(t));break;case"like":a.renderLikes(t,s.countLike(+t.dataset.key,"like"),"like");break;case"dislike":a.renderLikes(t,s.countLike(+t.dataset.key,"dislike"),"dislike")}}))},693:function(e,t,n){n(566)},984:function(e,t,n){function o(e,t,n,o,i){this.id=+e,this.author=t,this.text=o,this.likes=+i;const r=Date.parse(n);this.date=0==isNaN(r)?new Date(r).toISOString():(new Date).toISOString()}function i(e){this.comments=e}function r(e){const t=[],n=Array.from(e.elements).filter((e=>1==e.required));for(const e of n)e.value.trim()||t.push({elem:e,error:"Заполните, пожалуйста, обязательное поле"});return/\d{4}-\d{2}-\d{2}/.test(e.date.value)||t.push({elem:e.date,error:"Введите, пожалуйста, правильную дату"}),t}n.d(t,{G:function(){return r},H:function(){return i}}),i.prototype.addComment=function(e){const t=new o(this.comments.length>0?+this.comments.at(-1).id+1:1,e.author.value,e.date.value,e.text.value,0);return this.comments.push(t),t},i.prototype.removeComment=function(e){this.comments=this.comments.filter((t=>t.id!==e))},i.prototype.countLike=function(e,t){const n=this.comments.find((t=>t.id===e));return"like"===t?n.likes++:"dislike"===t&&(n.likes=n.likes<=1?0:--n.likes),n.likes}},411:function(e,t,n){function o(e,t,n,o,i){this.id=e,this.author=t,this.date=n,this.text=o,this.likes=i}n.d(t,{d:function(){return i}});const i=[new o(1,"Некрасов","1861-11-02","Однажды, в студеную зимнюю пору, я из лесу вышел. Был сильный мороз. Гляжу, поднимается медленно в гору лошадка, везущая хворосту воз.","5"),new o(2,"Aikidoka","2013-02-31T12:17:58.215Z","I would like to invite you on my Birthday","2")]},350:function(e,t,n){function o(){this.form=document.getElementsByName("commentform")[0],this.list=document.querySelector(".comments__list")}n.d(t,{u:function(){return o}}),o.prototype.renderTestData=function(e){this.list.innerHTML="";const t=new Date;this.form.date.value=`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`;for(const t of e)this.renderNewComment(t)},o.prototype.renderNewComment=function(e){const t=`\n  <li class="comments__item comment" data-key="${e.id}">\n    <div class="comment__author">${e.author}</div>\n    <div class="comment__date"> <time datetime="${e.date}">${this.renderDate(e.date)}</time></div>\n    <p class="comment__text">${e.text}</p>\n    <div class="comment__btn-row">\n      <div class="like comment__like icofont-ui-love" title="Нравится" data-action="like"></div>\n      <div class="like-count comment__like-count">${e.likes||""}</div>\n      <div class="comment__remove icofont-ui-delete" title="удалить" data-action="remove"></div>\n    </div>\n  </li>`;this.list.insertAdjacentHTML("beforeend",t)},o.prototype.renderDate=function(e){const t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),o=new Date(t.getFullYear(),t.getMonth(),t.getDate()-1),i=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1),r=new Date(e);return r>=n&&r<i?`сегодня, ${t.toLocaleTimeString("ru-RU").slice(0,-3)}`:r>=o&&r<n?`вчера, ${t.toLocaleTimeString("ru-RU").slice(0,-3)}`:`${r.toLocaleDateString("ru-RU")}, ${t.toLocaleTimeString("ru-RU").slice(0,-3)}`},o.prototype.showErrors=function(e){for(const t of e){const e=document.createElement("div");e.className="message-error",e.innerHTML=t.error,e.style.left=0,e.style.top="5px",t.elem.classList.add("invalid"),t.elem.after(e)}e[0].elem.focus()},o.prototype.removeMessages=function(){const e=document.querySelectorAll(".message-error");for(const t of e)t.remove()},o.prototype.removeMessage=function(e){const t=e.target;!t.nextElementSibling||"INPUT"!=t.tagName&&"TEXTAREA"!=t.tagName||(t.nextElementSibling.remove(),t.classList.remove("invalid"))},o.prototype.clearForm=function(e){e.reset();const t=new Date;e.date.value=`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`},o.prototype.removeCommentFromView=function(e){e.remove()},o.prototype.renderLikes=function(e,t,n){const o=e.querySelector(".like");e.querySelector(".like-count").textContent=t||"","like"===n?(o.setAttribute("title","Больше не нравится"),o.setAttribute("data-action","dislike")):"dislike"===n&&(o.setAttribute("title","Нравится"),o.setAttribute("data-action","like"))}}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n(566),n(693),n(984),n(411),n(350)}();